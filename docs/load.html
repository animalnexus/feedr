<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Loading in Data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">How to use feedr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="divider"></li>
<li>
  <a href="load.html">Loading</a>
</li>
<li>
  <a href="housekeeping.html">Housekeeping</a>
</li>
<li>
  <a href="transformations.html">Transformations</a>
</li>
<li>
  <a href="maps.html">Visualizations</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Loading in Data</h1>

</div>


<p><a id = "top"></a></p>
<p>This is a quick tutorial to get you started with loading in your own data. <code>feedr</code> includes several wrapper functions that can be used to load and format your data.</p>
<ul>
<li><a href="#loadraw"><code>load_raw()</code></a></li>
<li><a href="#loadrawall"><code>load_raw_web()</code></a></li>
<li><a href="#loadweb"><code>load_web()</code></a></li>
<li><a href="#dldata"><code>dl_data()</code></a></li>
</ul>
<p>These functions work with either <strong>raw</strong> feeder data (downloaded directly from the feeders) or <strong>web</strong> feeder data downloaded from the birdmoves websites (either by hand, from <a href="http://gaia.tru.ca/birdMOVES/datadownload.html" class="uri">http://gaia.tru.ca/birdMOVES/datadownload.html</a>, or with the <code>dl_data()</code> function.</p>
<div id="a-note-about-file-structure" class="section level2">
<h2>A note about file structure</h2>
<p>It’s important to remember that when specifying file locations, you must either specify a complete file id (e.g. /home/steffi/Desktop/data.csv) <strong>or</strong> an appropriate relative file location.</p>
<p>Also, remember that file locations are relative to where R’s working directory is, and this is not necessarily the same place as the R script with which you are working.</p>
<p>If you are using RStudio, it is highly recommended that you specify an RStudio project in the directory which holds your scripts. This way, anytime you open the file, the working directly is automatically set to your script directly.</p>
<p>Otherwise you should probably use Session &gt; Set Working Directory &gt; To Source File Location (if you’re using RStudio).</p>
<p><strong>This tutorial assumes that your data is stored in a folder called “Data” which is in turn stored in your R scripts folder.</strong></p>
<p><a id="loadraw"></a></p>
</div>
<div id="load_raw" class="section level2">
<h2><code>load_raw()</code></h2>
<p>This loads and formats a raw data file downloaded directly from feeder RFID readers.</p>
<pre class="r"><code>r1 &lt;- load_raw(&quot;./Data/exp1/GR10DATA_2015_12_09.TXT&quot;)
head(r1)</code></pre>
<pre><code>##      bird_id                time feeder_id
## 1 0000000000 2016-01-11 11:34:08      GR10
## 2 062000014F 2016-01-11 12:00:54      GR10
## 3 062000014F 2016-01-11 12:01:57      GR10
## 4 062000014F 2016-01-11 12:02:50      GR10
## 5 062000014F 2016-01-11 12:04:30      GR10
## 6 062000014F 2016-01-11 12:05:00      GR10</code></pre>
<p>Note that the feeder_id is taken from the file name. This is done by matching an expected pattern against the actual file name.</p>
<p>The default pattern matches GR or GPR followed by 1 or 2 digits. If you need to specify a different pattern you can do so:</p>
<pre class="r"><code>r1 &lt;- load_raw(&quot;./Data/exp1/Feeder_10_2015_12_09.TXT&quot;, feeder_pattern = &quot;Feeder_[0-9]{2}&quot;)
head(r1)</code></pre>
<p>For more information on how to write patterns, see documentation for “Regular Expressions” (e.g. <a href="http://www.regular-expressions.info/tutorial.html" class="uri">http://www.regular-expressions.info/tutorial.html</a>)</p>
<p><a id="loadrawall"></a></p>
</div>
<div id="load_raw_all" class="section level2">
<h2><code>load_raw_all()</code></h2>
<p>The function <code>load_raw_all()</code> is a wrapper function which will automatically load and combine data contained in several different files in a single folder, or in a nested series of folders. Other files can be present, but all feeder data files must be identifiable by a pattern in the file name.</p>
<p>In this example our data files are stored in a folder called <code>raw</code> and there are several sets of data, each corresponding to an individual experiment which are then stored in their own folder called <code>exp1</code>, <code>exp2</code>, etc. Feeder data files are identifiable by the characters ‘DATA’ present in the name (as in the above example), which is the default.</p>
<pre class="r"><code>r &lt;- load_raw_all(r_dir = &quot;./Data/raw&quot;)
head(r)</code></pre>
<pre><code>## Empty file skipped: /home/steffi/R/x86_64-pc-linux-gnu-library/3.3/feedr/extdata/raw/exp2/GR10DATA_2016_01_18.TXT</code></pre>
<pre><code>##      bird_id                time feeder_id
## 1 0000000000 2016-01-11 11:34:08      GR10
## 2 062000014F 2016-01-11 12:00:54      GR10
## 3 062000014F 2016-01-11 12:01:57      GR10
## 4 062000014F 2016-01-11 12:02:50      GR10
## 5 062000014F 2016-01-11 12:04:30      GR10
## 6 062000014F 2016-01-11 12:05:00      GR10</code></pre>
<p>If your feeder files didn’t have a identiifable label, but were the only csv files in the folders, you could use:</p>
<pre class="r"><code>r &lt;- load_raw_all(r_dir = &quot;./Data/raw&quot;, pattern = &quot;.csv&quot;)</code></pre>
<p>However, in this example we have several different experiments, which we’ll probably want to identify in our data. This is where the <code>extra</code> arguments come in.</p>
<p>In our example, each experiment is stored in its own folder (exp1 and exp2). Therefore we can tell our function to identify those patterns (<code>extra_pattern</code>) and store the values in an extra column (<code>extra_name</code>):</p>
<pre class="r"><code>r &lt;- load_raw_all(r_dir = &quot;./Data/raw&quot;, extra_pattern = &quot;exp[1-2]{1}&quot;, extra_name = &quot;experiment&quot;)</code></pre>
<pre><code>## Empty file skipped: /home/steffi/R/x86_64-pc-linux-gnu-library/3.3/feedr/extdata/raw/exp2/GR10DATA_2016_01_18.TXT</code></pre>
<pre><code>##      bird_id                time feeder_id experiment
## 1 0000000000 2016-01-11 11:34:08      GR10       exp2
## 2 062000014F 2016-01-11 12:00:54      GR10       exp2
## 3 062000014F 2016-01-11 12:01:57      GR10       exp2
## 4 062000014F 2016-01-11 12:02:50      GR10       exp2
## 5 062000014F 2016-01-11 12:04:30      GR10       exp2
## 6 062000014F 2016-01-11 12:05:00      GR10       exp2</code></pre>
<p>“exp[1-2]{1}” matches the exact characters “exp” followed by either a 1 or a 2 of which there is exactly 1.</p>
<p>We can also merge in some extra values for use later (visualizations, etc.)</p>
<pre><code>##   experiment feeder_id      lat       lon
## 1       exp1      GR10 53.89404 -122.8180
## 2       exp1      GR11 53.89304 -122.8183
## 3       exp1      GR12 53.89324 -122.8208
## 4       exp1      GR13 53.89410 -122.8201
## 5       exp2      GR10 53.89086 -122.8193
## 6       exp2      GR11 53.88999 -122.8210
## 7       exp2      GR12 53.88997 -122.8193
## 8       exp2      GR13 53.89088 -122.8208</code></pre>
<pre class="r"><code>f.index &lt;- read.csv(&quot;./Data/feeder_index.csv&quot;)
f.index</code></pre>
<pre class="r"><code>r &lt;- merge(r, f.index, by = c(&quot;experiment&quot;, &quot;feeder_id&quot;))
head(r)</code></pre>
<pre><code>##   experiment feeder_id    bird_id                time      lat       lon
## 1       exp2      GR10 062000038D 2016-01-11 11:03:44 53.89086 -122.8193
## 2       exp2      GR10 062000038D 2016-01-11 11:05:03 53.89086 -122.8193
## 3       exp2      GR10 062000038D 2016-01-11 11:05:59 53.89086 -122.8193
## 4       exp2      GR10 062000038D 2016-01-11 11:06:03 53.89086 -122.8193
## 5       exp2      GR10 062000038D 2016-01-11 11:06:29 53.89086 -122.8193
## 6       exp2      GR10 062000038D 2016-01-11 11:05:29 53.89086 -122.8193</code></pre>
<p>Because here, the feeder units were reused for different experiments, some feeders have the same id, but a different lat/lon. This will create problems later on, so let’s create unique feeder_id names:</p>
<pre class="r"><code>r$feeder_id &lt;- paste(r$experiment, r$feeder_id, sep = &quot;-&quot;)
head(r)</code></pre>
<pre><code>##   experiment feeder_id    bird_id                time      lat       lon
## 1       exp2 exp2-GR10 062000038D 2016-01-11 11:03:44 53.89086 -122.8193
## 2       exp2 exp2-GR10 062000038D 2016-01-11 11:05:03 53.89086 -122.8193
## 3       exp2 exp2-GR10 062000038D 2016-01-11 11:05:59 53.89086 -122.8193
## 4       exp2 exp2-GR10 062000038D 2016-01-11 11:06:03 53.89086 -122.8193
## 5       exp2 exp2-GR10 062000038D 2016-01-11 11:06:29 53.89086 -122.8193
## 6       exp2 exp2-GR10 062000038D 2016-01-11 11:05:29 53.89086 -122.8193</code></pre>
<p><a id="loadweb"></a></p>
</div>
<div id="load_web" class="section level2">
<h2><code>load_web()</code></h2>
<p>You can go to <a href="http://gaia.tru.ca/birdMOVES/datadownload.html" class="uri">http://gaia.tru.ca/birdMOVES/datadownload.html</a> and download a csv file of data from the BirdMoves website. To load and format this data for use with the feedr package, run:</p>
<pre class="r"><code>r &lt;- load_web(&quot;./Data/load_web.csv&quot;)
head(r)</code></pre>
<pre><code>##      bird_id                time feeder_id     species       lon      lat
## 1 0620000514 2016-01-28 12:34:25      2200 House Finch -120.3612 50.66778
## 2 0620000514 2016-01-28 12:34:28      2200 House Finch -120.3612 50.66778
## 3 041868D861 2016-01-28 12:35:41      2200 House Finch -120.3612 50.66778
## 4 06200004F8 2016-01-28 12:35:52      2200 House Finch -120.3612 50.66778
## 5 06200004F8 2016-01-28 12:35:59      2200 House Finch -120.3612 50.66778
## 6 06200004F8 2016-01-28 12:36:02      2200 House Finch -120.3612 50.66778</code></pre>
<p>The default timezone is “America/Vancouver”, therefore, if your data is from a different time zone, you need to specify that manually. Make sure you use a timezone name from the output of OlsonNames(). For example:</p>
<pre class="r"><code>r &lt;- load_web(&quot;./Data/load_web.csv&quot;, tz = &quot;America/Costa_Rica&quot;)
r$time[1]
head(r)</code></pre>
<pre><code>## [1] &quot;2016-01-28 12:34:25 CST&quot;</code></pre>
<pre><code>##      bird_id                time feeder_id     species       lon      lat
## 1 0620000514 2016-01-28 12:34:25      2200 House Finch -120.3612 50.66778
## 2 0620000514 2016-01-28 12:34:28      2200 House Finch -120.3612 50.66778
## 3 041868D861 2016-01-28 12:35:41      2200 House Finch -120.3612 50.66778
## 4 06200004F8 2016-01-28 12:35:52      2200 House Finch -120.3612 50.66778
## 5 06200004F8 2016-01-28 12:35:59      2200 House Finch -120.3612 50.66778
## 6 06200004F8 2016-01-28 12:36:02      2200 House Finch -120.3612 50.66778</code></pre>
<p><strong>Note:</strong> This doesn’t <em>convert</em> the time from one zone to another, it merely <em>assigns</em> the timezone. Make sure this matches the timezone of the original data download.</p>
<p><a id="dldata"></a></p>
</div>
<div id="dl_data" class="section level2">
<h2><code>dl_data()</code></h2>
<p>This is likely the easiest way to get data (provided the data you’re interested in is hosted on the BirdMoves website). This function requests data from the BirdMoves website and formats it for use with the feedr transformation functions.</p>
<p>If you don’t specify anything, all data will be downloaded for the default site (Kamloops) and the default extra columns (loc and species) with the default timezone (America/Vancouver). See ?dl_data for more details.</p>
<pre><code>##      bird_id                time feeder_id            species       lon
## 1 062000031A 2015-09-02 08:25:58      2100 Mountain Chickadee -120.3624
## 2 062000031A 2015-09-02 08:26:01      2100 Mountain Chickadee -120.3624
## 3 062000031A 2015-09-03 10:12:20      2100 Mountain Chickadee -120.3624
## 4 062000031A 2015-09-03 10:12:23      2100 Mountain Chickadee -120.3624
## 5 062000031A 2015-09-05 16:32:20      2100 Mountain Chickadee -120.3624
## 6 062000031A 2015-09-05 16:32:23      2100 Mountain Chickadee -120.3624
##        lat
## 1 50.66896
## 2 50.66896
## 3 50.66896
## 4 50.66896
## 5 50.66896
## 6 50.66896</code></pre>
<pre class="r"><code>r &lt;- dl_data()
head(r)</code></pre>
<p>You can specify start and end times:</p>
<pre class="r"><code>r &lt;- dl_data(start = &quot;2015-10-01&quot;, end = &quot;2015-10-02&quot;)
head(r)</code></pre>
<pre><code>##      bird_id                time feeder_id     species       lon      lat
## 1 06200003AA 2015-10-01 08:24:44      2700 House Finch -120.3632 50.66909
## 2 06200003AA 2015-10-01 08:24:46      2700 House Finch -120.3632 50.66909
## 3 06200003AA 2015-10-01 08:24:49      2700 House Finch -120.3632 50.66909
## 4 06200003AA 2015-10-01 08:24:51      2700 House Finch -120.3632 50.66909
## 5 06200003AA 2015-10-01 08:24:53      2700 House Finch -120.3632 50.66909
## 6 06200003AA 2015-10-01 08:24:55      2700 House Finch -120.3632 50.66909</code></pre>
<pre class="r"><code>r &lt;- dl_data(start = &quot;2015-10-01 09:00:00&quot;, end = &quot;2015-10-02&quot;)
head(r)</code></pre>
<pre><code>##      bird_id                time feeder_id     species       lon      lat
## 1 06200003AA 2015-10-01 09:15:32      2700 House Finch -120.3632 50.66909
## 2 06200004F8 2015-10-01 09:15:50      2700 House Finch -120.3632 50.66909
## 3 06200004F8 2015-10-01 09:16:13      2700 House Finch -120.3632 50.66909
## 4 06200004F8 2015-10-01 09:16:15      2700 House Finch -120.3632 50.66909
## 5 06200004F8 2015-10-01 09:16:17      2700 House Finch -120.3632 50.66909
## 6 06200004F8 2015-10-01 09:16:20      2700 House Finch -120.3632 50.66909</code></pre>
<p>You can also specify only a start or an end, all data up to or after that point will be grabbed:</p>
<pre class="r"><code>r &lt;- dl_data(end = &quot;2015-09-06&quot;)
head(r)</code></pre>
<pre><code>##      bird_id                time feeder_id            species       lon
## 1 062000031A 2015-09-02 08:25:58      2100 Mountain Chickadee -120.3624
## 2 062000031A 2015-09-02 08:26:01      2100 Mountain Chickadee -120.3624
## 3 062000031A 2015-09-03 10:12:20      2100 Mountain Chickadee -120.3624
## 4 062000031A 2015-09-03 10:12:23      2100 Mountain Chickadee -120.3624
## 5 062000031A 2015-09-05 16:32:20      2100 Mountain Chickadee -120.3624
## 6 062000031A 2015-09-05 16:32:23      2100 Mountain Chickadee -120.3624
##        lat
## 1 50.66896
## 2 50.66896
## 3 50.66896
## 4 50.66896
## 5 50.66896
## 6 50.66896</code></pre>
<p>Extra bird or feeder related details (?dl_data for more):</p>
<pre class="r"><code>r &lt;- dl_data(end = &quot;2015-09-06&quot;, feeder_details = c(&quot;loc&quot;,&quot;site_name&quot;), bird_details = c(&quot;species&quot;, &quot;age&quot;, &quot;sex&quot;))
head(r)</code></pre>
<pre><code>##      bird_id                time feeder_id    site_name            species
## 1 062000031A 2015-09-02 08:25:58      2100 Kamloops, BC Mountain Chickadee
## 2 062000031A 2015-09-02 08:26:01      2100 Kamloops, BC Mountain Chickadee
## 3 062000031A 2015-09-03 10:12:20      2100 Kamloops, BC Mountain Chickadee
## 4 062000031A 2015-09-03 10:12:23      2100 Kamloops, BC Mountain Chickadee
## 5 062000031A 2015-09-05 16:32:20      2100 Kamloops, BC Mountain Chickadee
## 6 062000031A 2015-09-05 16:32:23      2100 Kamloops, BC Mountain Chickadee
##   age sex       lon      lat
## 1  SY   M -120.3624 50.66896
## 2  SY   M -120.3624 50.66896
## 3  SY   M -120.3624 50.66896
## 4  SY   M -120.3624 50.66896
## 5  SY   M -120.3624 50.66896
## 6  SY   M -120.3624 50.66896</code></pre>
<hr />
<p>Back to <a href="#top">top</a><br />
Go back to <a href="feedr.html">main document</a> | Continue with <a href="housekeeping.html">housekeeping</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
