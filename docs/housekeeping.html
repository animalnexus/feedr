<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Housekeeping</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">How to use feedr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="divider"></li>
<li>
  <a href="load.html">Loading</a>
</li>
<li>
  <a href="housekeeping.html">Housekeeping</a>
</li>
<li>
  <a href="transformations.html">Transformations</a>
</li>
<li>
  <a href="maps.html">Visualizations</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Housekeeping</h1>

</div>


<p>This is a quick tutorial covering a couple functions you can use to clean and fix problems in your data.</p>
<ul>
<li><a href="#checkids"><code>check_ids()</code></a></li>
<li><a href="#checkproblems"><code>check_problems()</code></a></li>
</ul>
<p>These functions can be skipped, or used one after the other. It’s up to you. Basically, they are wrapper functions for cleaning your data while maintaining appropriate categorical (factor) levels.</p>
<p>This tutorial assumes that you already know how to <a href="load.html">load/import</a> your data. We will be using the <code>feedr</code> package example data set: finches.</p>
<pre class="r"><code>head(finches)</code></pre>
<pre><code>##    animal_id       date                time logger_id     species age sex    site_name       lon      lat
## 1 0620000514 2016-01-28 2016-01-28 12:34:25      2200 House Finch AHY   F Kamloops, BC -120.3612 50.66778
## 2 0620000514 2016-01-28 2016-01-28 12:34:28      2200 House Finch AHY   F Kamloops, BC -120.3612 50.66778
## 3 041868D861 2016-01-28 2016-01-28 12:35:41      2200 House Finch AHY   M Kamloops, BC -120.3612 50.66778
## 4 06200004F8 2016-01-28 2016-01-28 12:35:52      2200 House Finch AHY   F Kamloops, BC -120.3612 50.66778
## 5 06200004F8 2016-01-28 2016-01-28 12:35:59      2200 House Finch AHY   F Kamloops, BC -120.3612 50.66778
## 6 06200004F8 2016-01-28 2016-01-28 12:36:02      2200 House Finch AHY   F Kamloops, BC -120.3612 50.66778</code></pre>
<p><a id = "checkids"></a></p>
<div id="check_ids" class="section level2">
<h2><code>check_ids()</code></h2>
<p>This function can be used to remove any <code>animal_ids</code> that are present, but which you know aren’t really animals. For example, if you use a ‘wand’ to test the deployment of your loggers, this is an <code>animal_id</code> that you should remove prior to analysis. Further, occasionally there are <code>animal_ids</code> that are error codes (e.g. 0000000000), you may wish to determine why these are present (you probably should!), but once again, for analysis they should be removed.</p>
<p>This function works by comparing the list of <code>animal_ids</code> in the data to an external, <code>animal_id</code> data set. The data set is expected to have at least two columns: <code>animal_id</code> and <code>species</code>. The <code>species</code> column should either contain species identity (e.g. House Finch or HOFI) or the error code (e.g. wand, or error).</p>
<p>In addition to removing error or wand ids, this function will also report which <code>animal_id</code>s are in your data sets, but not in your <code>animal_id</code> index, and which are in your <code>animal_id</code> index, but not in your data sets. This will help you determine whether you are detecting RFID tags that are not in your master index (weird!) and whether some RFID tags have never been recorded by a logger.</p>
<div id="with-no-errorwand-ids" class="section level3">
<h3>With no error/wand ids</h3>
<p>Let’s load an animal index file. Note that there are no errors or wands ids.</p>
<pre class="r"><code>animal_index &lt;- read.csv(&quot;./Data/animal_index.csv&quot;)
animal_index</code></pre>
<pre><code>##    animal_id     species
## 1 0620000514 House Finch
## 2 041868D861 House Finch
## 3 06200004F8 House Finch
## 4 062000043E House Finch
## 5 041868D396 House Finch</code></pre>
<p>You need to give this function a data set, and it will return a cleaned data set. Here we’ll save it as r_clean:</p>
<pre class="r"><code>r_clean &lt;- check_ids(finches, ids = animal_index)</code></pre>
<pre><code>## All animal_ids in your data are also in your animal_id index</code></pre>
<pre><code>## All animal_ids in your animal_id index are also in your data</code></pre>
<pre><code>## animal_id index (id) data frame doesn&#39;t contain any animal_ids to omit</code></pre>
<pre><code>## No animal_ids have been omitted</code></pre>
<p>This output shows that all the <code>animal_id</code>s in the data are also in the index and vice versa. Further, there were no omitted ids (error or wand ids).</p>
<p><strong>Note</strong>: You can also skip loading the index and simply provide <code>check_ids()</code> with the location of the index file:</p>
<pre class="r"><code>r_clean &lt;- check_ids(finches, ids = &quot;./Data/animal_index.csv&quot;)</code></pre>
<pre><code>## All animal_ids in your data are also in your animal_id index</code></pre>
<pre><code>## All animal_ids in your animal_id index are also in your data</code></pre>
<pre><code>## animal_id index (id) data frame doesn&#39;t contain any animal_ids to omit</code></pre>
<pre><code>## No animal_ids have been omitted</code></pre>
</div>
<div id="with-errorwand-ids" class="section level3">
<h3>With error/wand ids</h3>
<p>Let’s see how it works if you did have a ‘wand’ or ‘error’ code in your index file that matched a <code>animal_id</code> in your data set.</p>
<pre class="r"><code>animal_index</code></pre>
<pre><code>##    animal_id     species
## 1 0620000514        wand
## 2 041868D861       error
## 3 06200004F8 House Finch
## 4 062000043E House Finch
## 5 041868D396 House Finch</code></pre>
<pre class="r"><code>r_clean &lt;- check_ids(finches, ids = animal_index)</code></pre>
<pre><code>## All animal_ids in your data are also in your animal_id index</code></pre>
<pre><code>## All animal_ids in your animal_id index are also in your data</code></pre>
<pre><code>## The following animal_ids have been omitted: 0620000514, 041868D861</code></pre>
<p>Here we omitted two <code>animal_id</code>s, one associated with a wand (0620000514) and one with an error (041868D861).</p>
<p>Note that nothing else changed.</p>
</div>
<div id="animal_ids-present-in-data-set-but-not-in-the-index" class="section level3">
<h3><code>animal_id</code>s present in data set but not in the index</h3>
<pre class="r"><code>animal_index</code></pre>
<pre><code>##    animal_id     species
## 1 0620000514        wand
## 2 041868D861       error
## 3 06200004F8 House Finch
## 4 062000043E House Finch</code></pre>
<pre class="r"><code>r_clean &lt;- check_ids(finches, ids = animal_index)</code></pre>
<pre><code>## Some animal_ids present in your data do not exist in the animal_id index: 041868D396</code></pre>
<pre><code>## All animal_ids in your animal_id index are also in your data</code></pre>
<pre><code>## The following animal_ids have been omitted: 0620000514, 041868D861</code></pre>
<p><a id = "checkproblems"></a></p>
</div>
</div>
<div id="check_problems" class="section level2">
<h2><code>check_problems()</code></h2>
<p>This function is only necessary if, for some reason, you’re getting errors in the recorded <code>animal_id</code>s.</p>
<p>This function will correct all instances of an <code>animal_id</code> according to the list provided.</p>
<pre class="r"><code>problems &lt;- read.csv(&quot;./Data/problems.csv&quot;)
problems</code></pre>
<pre><code>##   original_id corrected_id
## 1  06200004F8   041B6BEF6B
## 2  041868D396   041B999F6B</code></pre>
<p>Original <code>animal_id</code>s:</p>
<pre class="r"><code>finches$animal_id[1:5]</code></pre>
<pre><code>## [1] 0620000514 0620000514 041868D861 06200004F8 06200004F8
## Levels: 041868D396 041868D861 062000043E 06200004F8 0620000514</code></pre>
<p>Fix problems and new <code>animal_id</code>s:</p>
<pre class="r"><code>r_clean &lt;- check_problems(finches, problems = problems)</code></pre>
<pre><code>## The following animal ids have been corrected:</code></pre>
<pre><code>## 06200004F8 to 041B6BEF6B
## 041868D396 to 041B999F6B</code></pre>
<pre class="r"><code>r_clean$animal_id[1:5]</code></pre>
<pre><code>## [1] 0620000514 0620000514 041868D861 041B6BEF6B 041B6BEF6B
## Levels: 041868D861 062000043E 0620000514 041B6BEF6B 041B999F6B</code></pre>
<p>Note that the <code>animal_id</code>s have been modified, but also that the factor levels have been updated to match.</p>
<p>Now that your data has been cleaned of erroneous or problematic data, it is ready to be <a href="transformations.html">transformed</a>.</p>
<hr />
<p>Back to <a href="#top">top</a><br />
Go back to <a href="index.html">home</a> | Go back to <a href="load.html">loading/importing data</a> | Continue with <a href="transformations.html">transformations</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
