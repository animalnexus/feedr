---
title: "Visualizing Data"
author: "Steffi LaZerte"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Visualizing Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r, include = F}
library(feedr)
```

This is a quick tutorial to get you started with visualizing your data. `feedr` includes two wrapper functions that can be used to visualize your data on maps. These two functions, `map.ggmap` and `map.leaflet` are really just convenience functions to do a lot of the grunt work. If you want to achieve a more fine tuned map, I suggest you check out the packages `ggmap` and `leaflet`.

## `map.ggmap()`

This creates static maps using the package `ggmap`.

```{r, echo = FALSE}
r <- load.web(system.file("extdata", "downloaded_file.csv", package = "feedr"))
```

```{r, eval = FALSE}
r <- load.web("./Data/downloaded_file.csv")
```

```{r}
v <- visits(r)

```

## `load.raw()`

### Load in a single file:
```{r echo = FALSE}
all.files <- list.files(system.file("extdata", "raw", "exp1", package = "feedr"), full.names = T)
r <- load.raw(all.files[1])
```

```{r eval = FALSE}
r <- load.raw("./Data/exp1/GR10DATA_2015_12_09.TXT")
```

```{r}
head(r)
```

### Load in and combine multiple files:

Assuming your files are stored in a folder called `raw` and each set of files is in its own folder called `exp1`, `exp2`, etc.

First you need to list all the files you want to load:
```{r eval = FALSE}
all.files <- list.files("./Data/raw/exp1", full.names = TRUE)
```

Now do some R-fu:

```{r eval = FALSE}
r <- do.call('rbind', lapply(all.files, load.raw))
```

```{r}
head(r)
```

### Load in and combine multiple files stored in different folders:

First you need to list all the files you want to load (and ONLY the files you want to load):

```{r echo = FALSE}
all.files <- list.files(system.file("extdata", package = "feedr"), "G", recursive = TRUE, full.names = T)
```
```{r eval = FALSE}
all.files <- list.files("./Data/raw/", recursive = TRUE)
```

Now you can load these files as above:
```{r eval = TRUE}
r <- do.call('rbind', lapply(all.files, load.raw))
head(r)
```

If the file names are informative beyond specifying `feeder_id` we can also pull that in. In this case, we'll ask `load.raw` to match the `exp1`, `exp2`, etc., as this reflects which experiment the data belongs to. Here I've added line returns to make the code more readable.

```{r}
r <- do.call('rbind', 
             lapply(all.files, 
                    load.raw, 
                    extra_pattern = "exp[0-9]{1,2}", 
                    extra_name = "experiment"))
head(r)
```
